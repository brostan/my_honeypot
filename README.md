# Cowrie SSH/Telnet Honeypot - ะัะพะตะบั ัะฐะทะฒะตัััะฒะฐะฝะธั

![Cowrie Logo](https://www.cowrie.org/cowrie.png)

## ๐ ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ

ะญัะพั ะฟัะพะตะบั ะฟัะตะดััะฐะฒะปัะตั ัะพะฑะพะน ะฟะพะปะฝะพะต ัะตัะตะฝะธะต ะดะปั ัะฐะทะฒะตัััะฒะฐะฝะธั ะธ ะผะพะฝะธัะพัะธะฝะณะฐ SSH/Telnet honeypot ะฝะฐ ะฑะฐะทะต [Cowrie](https://github.com/cowrie/cowrie). Honeypot ะธะผะธัะธััะตั ััะทะฒะธะผัั ัะธััะตะผั ะดะปั ะฟัะธะฒะปะตัะตะฝะธั ะธ ะฐะฝะฐะปะธะทะฐ ะฐัะฐะบ ะทะปะพัะผััะปะตะฝะฝะธะบะพะฒ.

## ๐ฏ ะะพะทะผะพะถะฝะพััะธ

- **SSH Honeypot** - ัะผัะปััะธั SSH ัะตัะฒะตัะฐ ะฝะฐ ะฟะพััั 22/2222
- **Telnet Honeypot** - ัะผัะปััะธั Telnet ัะตัะฒะตัะฐ ะฝะฐ ะฟะพััั 23/2223
- **ะะพะณะธัะพะฒะฐะฝะธะต ะฒัะตั ะดะตะนััะฒะธะน** - ะบะพะผะฐะฝะดั, ะฟะพะฟััะบะธ ะฒัะพะดะฐ, ะทะฐะณััะถะตะฝะฝัะต ัะฐะนะปั
- **Replay ัะตััะธะน** - ะฒะพะทะผะพะถะฝะพััั ะฒะพัะฟัะพะธะทะฒะตะดะตะฝะธั ะดะตะนััะฒะธะน ะฐัะฐะบัััะธั
- **ะะพะฝะธัะพัะธะฝะณ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ** - ะธะฝัะตะณัะฐัะธั ั ELK Stack ะธ Grafana
- **Docker ะฟะพะดะดะตัะถะบะฐ** - ะฟัะพััะพะต ัะฐะทะฒะตัััะฒะฐะฝะธะต ัะตัะตะท Docker Compose
- **ะะฒัะพะผะฐัะธะทะฐัะธั** - ัะบัะธะฟัั ะดะปั ัะฐะทะฒะตัััะฒะฐะฝะธั ะฝะฐ ัะตัะฒะตัะต

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    Internet / Attackers                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ
                    โโโโโโผโโโโโโ
                    โ Port 22  โ  SSH Traffic
                    โ Port 23  โ  Telnet Traffic
                    โโโโโโฌโโโโโโ
                         โ
         โโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
         โ      Cowrie Honeypot           โ
         โ  - Fake SSH/Telnet Server      โ
         โ  - Command Logging             โ
         โ  - File Capture                โ
         โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโ
                     โ
         โโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโ
         โ     Logging & Analysis         โ
         โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
         โ โข JSON Logs                    โ
         โ โข Elasticsearch (storage)      โ
         โ โข Kibana (visualization)       โ
         โ โข Grafana (dashboards)         โ
         โ โข Logstash (processing)        โ
         โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ฆ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
Honeypot/
โโโ cowrie/                    # ะะปะพะฝ ัะตะฟะพะทะธัะพัะธั Cowrie
โ   โโโ etc/
โ   โ   โโโ cowrie.cfg        # ะะพะฝัะธะณััะฐัะธั honeypot
โ   โ   โโโ userdb.txt        # ะะฐะทะฐ ััะตัะฝัั ะดะฐะฝะฝัั
โ   โโโ var/
โ   โ   โโโ log/              # ะะพะณะธ
โ   โ   โโโ lib/
โ   โ       โโโ downloads/    # ะะฐะณััะถะตะฝะฝัะต ัะฐะนะปั
โ   โ       โโโ tty/          # ะะฐะฟะธัะธ ัะตััะธะน
โ   โโโ cowrie-env/           # Python virtual environment
โโโ docker-compose.yml        # ะะพะปะฝัะน ััะตะบ ั ะผะพะฝะธัะพัะธะฝะณะพะผ
โโโ docker-compose.simple.yml # ะขะพะปัะบะพ Cowrie
โโโ deploy.sh                 # ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ัะฐะทะฒะตัััะฒะฐะฝะธั
โโโ logstash/
โ   โโโ pipeline/
โ       โโโ cowrie.conf       # ะะพะฝัะธะณััะฐัะธั Logstash
โโโ README.md                 # ะญัะฐ ะดะพะบัะผะตะฝัะฐัะธั
```

## ๐ ะัััััะน ััะฐัั

### ะะฐัะธะฐะฝั 1: Docker Compose (ัะตะบะพะผะตะฝะดัะตััั)

#### ะัะพััะพะต ัะฐะทะฒะตัััะฒะฐะฝะธะต (ัะพะปัะบะพ Cowrie)

```bash
# ะะปะพะฝะธััะนัะต ะฟัะพะตะบั
git clone <your-repo-url>
cd Honeypot

# ะะฐะฟัััะธัะต Cowrie
docker-compose -f docker-compose.simple.yml up -d

# ะัะพะฒะตัััะต ััะฐััั
docker-compose -f docker-compose.simple.yml ps

# ะัะพัะผะพัั ะปะพะณะพะฒ
docker-compose -f docker-compose.simple.yml logs -f cowrie
```

#### ะะพะปะฝะพะต ัะฐะทะฒะตัััะฒะฐะฝะธะต (ั ะผะพะฝะธัะพัะธะฝะณะพะผ)

```bash
# ะะฐะฟัััะธัะต ะฒะตัั ััะตะบ
docker-compose up -d

# ะัะพะฒะตัััะต ััะฐััั ะฒัะตั ัะตัะฒะธัะพะฒ
docker-compose ps
```

ะะพัะปะต ะทะฐะฟััะบะฐ ะดะพัััะฟะฝั ัะปะตะดัััะธะต ะธะฝัะตััะตะนัั:
- **Cowrie SSH**: `ssh -p 2222 root@localhost`
- **Cowrie Telnet**: `telnet localhost 2223`
- **Kibana**: http://localhost:5601
- **Grafana**: http://localhost:3000 (admin/admin)
- **Elasticsearch**: http://localhost:9200
- **Portainer**: https://localhost:9443

### ะะฐัะธะฐะฝั 2: ะะฐัะธะฒะฝะฐั ัััะฐะฝะพะฒะบะฐ ะฝะฐ ัะตัะฒะตัะต

```bash
# ะกะบะพะฟะธััะนัะต ะฟัะพะตะบั ะฝะฐ ัะตัะฒะตั
scp -r Honeypot user@your-server:/home/user/

# ะะพะดะบะปััะธัะตัั ะบ ัะตัะฒะตัั
ssh user@your-server

# ะะฐะฟัััะธัะต ัะบัะธะฟั ัะฐะทะฒะตัััะฒะฐะฝะธั
cd /home/user/Honeypot
chmod +x deploy.sh
./deploy.sh
```

ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะธ:
1. ะฃััะฐะฝะพะฒะธั ะฒัะต ะทะฐะฒะธัะธะผะพััะธ
2. ะกะพะทะดะฐัั ะฟะพะปัะทะพะฒะฐัะตะปั `cowrie`
3. ะะฐัััะพะธั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต Python
4. ะฃััะฐะฝะพะฒะธั Cowrie
5. ะะฐัััะพะธั systemd service
6. ะะฐัััะพะธั ะปะพะณัะพัะฐัะธั
7. ะะฐะฟัััะธั honeypot

## โ๏ธ ะะพะฝัะธะณััะฐัะธั

### ะัะฝะพะฒะฝัะต ะฝะฐัััะพะนะบะธ (cowrie/etc/cowrie.cfg)

```ini
[honeypot]
sensor_name = honeypot-main
hostname = production-server

[ssh]
enabled = true
listen_endpoints = tcp:2222:interface=0.0.0.0

[telnet]
enabled = true
listen_endpoints = tcp:2223:interface=0.0.0.0
```

### ะฃัะตัะฝัะต ะดะฐะฝะฝัะต (cowrie/etc/userdb.txt)

ะคะพัะผะฐั: `username:unused:password`

```
root:x:toor
root:x:12345678
admin:x:admin
*:x:*  # ะะฐะทัะตัะธัั ะปัะฑะพะน ะปะพะณะธะฝ/ะฟะฐัะพะปั
```

### ะะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธะต ะฟะพััะพะฒ

ะะปั ะฟัะพัะปััะธะฒะฐะฝะธั ััะฐะฝะดะฐััะฝัั ะฟะพััะพะฒ (22, 23) ะธัะฟะพะปัะทัะนัะต iptables:

```bash
# SSH: ะฟะตัะตะฝะฐะฟัะฐะฒะธัั 22 -> 2222
sudo iptables -t nat -A PREROUTING -p tcp --dport 22 -j REDIRECT --to-port 2222

# Telnet: ะฟะตัะตะฝะฐะฟัะฐะฒะธัั 23 -> 2223
sudo iptables -t nat -A PREROUTING -p tcp --dport 23 -j REDIRECT --to-port 2223

# ะกะพััะฐะฝะธัั ะฟัะฐะฒะธะปะฐ
sudo netfilter-persistent save
```

ะะปะธ ะธัะฟะพะปัะทัะนัะต authbind (ะฝะฐัััะฐะธะฒะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะบัะธะฟัะพะผ `deploy.sh`).

## ๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะฐะฝะฐะปะธะท

### ะัะพัะผะพัั ะปะพะณะพะฒ

```bash
# ะขะตะบััะพะฒัะต ะปะพะณะธ
tail -f cowrie/var/log/cowrie/cowrie.log

# JSON ะปะพะณะธ
tail -f cowrie/var/log/cowrie/cowrie.json | jq .

# Docker ะปะพะณะธ
docker logs -f cowrie-honeypot
```

### ะะพัะฟัะพะธะทะฒะตะดะตะฝะธะต ัะตััะธะน

```bash
cd cowrie
./bin/playlog var/lib/cowrie/tty/20231210-120000-abcd1234.log
```

### ะัะพัะผะพัั ะทะฐะณััะถะตะฝะฝัั ัะฐะนะปะพะฒ

```bash
ls -lh cowrie/var/lib/cowrie/downloads/
```

### ะะฝะฐะปะธะท ะฒ Kibana

1. ะัะบัะพะนัะต http://localhost:5601
2. ะะตัะตะนะดะธัะต ะฒ **Management** โ **Index Patterns**
3. ะกะพะทะดะฐะนัะต index pattern: `cowrie-*`
4. ะะตัะตะนะดะธัะต ะฒ **Discover** ะดะปั ะฟัะพัะผะพััะฐ ัะพะฑััะธะน

### ะกะพะทะดะฐะฝะธะต ะดะฐัะฑะพัะดะพะฒ ะฒ Grafana

1. ะัะบัะพะนัะต http://localhost:3000
2. ะะพะนะดะธัะต (admin/admin)
3. ะะพะฑะฐะฒััะต Elasticsearch ะบะฐะบ Data Source
4. ะกะพะทะดะฐะนัะต ะดะฐัะฑะพัะดั ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ:
   - ะะพะฟััะบะธ ะฒัะพะดะฐ ะฟะพ ะฒัะตะผะตะฝะธ
   - ะขะพะฟ ะธัะฟะพะปัะทัะตะผัั ะฟะฐัะพะปะตะน
   - ะะตะพะณัะฐัะธั ะฐัะฐะบ (GeoIP)
   - ะะฐะธะฑะพะปะตะต ะฒัะฟะพะปะฝัะตะผัะต ะบะพะผะฐะฝะดั

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะะฐะถะฝัะต ัะตะบะพะผะตะฝะดะฐัะธะธ

1. **ะะทะพะปะธััะนัะต honeypot** - ะธัะฟะพะปัะทัะนัะต ะพัะดะตะปัะฝัั ัะตัั/VLAN
2. **ะะต ััะฐะฝะธัะต ััะฒััะฒะธัะตะปัะฝัะต ะดะฐะฝะฝัะต** ะฝะฐ ัะตัะฒะตัะต ั honeypot
3. **ะะพะฝะธัะพัััะต ะธััะพะดััะธะน ััะฐัะธะบ** - ะฟัะตะดะพัะฒัะฐัะฐะนัะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต honeypot ะดะปั ะฐัะฐะบ
4. **ะะตะณัะปััะฝะพ ะพะฑะฝะพะฒะปัะนัะต** Cowrie ะธ ะทะฐะฒะธัะธะผะพััะธ
5. **ะะณัะฐะฝะธัััะต ะดะพัััะฟ** ะบ ะธะฝัะตััะตะนัะฐะผ ะผะพะฝะธัะพัะธะฝะณะฐ (Kibana, Grafana)

### Firewall ะฟัะฐะฒะธะปะฐ

```bash
# ะะฐะทัะตัะธัั ะฒัะพะดััะธะต SSH/Telnet ะฝะฐ honeypot
sudo ufw allow 22/tcp
sudo ufw allow 23/tcp

# ะะฐะทัะตัะธัั ะดะพัััะฟ ะบ ะผะพะฝะธัะพัะธะฝะณั ัะพะปัะบะพ ั ะพะฟัะตะดะตะปะตะฝะฝัั IP
sudo ufw allow from YOUR_IP to any port 5601  # Kibana
sudo ufw allow from YOUR_IP to any port 3000  # Grafana

# ะะปะพะบะธัะพะฒะฐัั ะธััะพะดััะธะต ะฟะพะดะบะปััะตะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)
sudo ufw default deny outgoing
sudo ufw allow out 53/udp  # DNS
sudo ufw allow out 80/tcp  # HTTP
sudo ufw allow out 443/tcp # HTTPS
```

## ๐๏ธ ะฃะฟัะฐะฒะปะตะฝะธะต

### Systemd ะบะพะผะฐะฝะดั (ะฝะฐัะธะฒะฝะฐั ัััะฐะฝะพะฒะบะฐ)

```bash
# ะัะพะฒะตัะธัั ััะฐััั
sudo systemctl status cowrie

# ะััะฐะฝะพะฒะธัั
sudo systemctl stop cowrie

# ะะฐะฟัััะธัั
sudo systemctl start cowrie

# ะะตัะตะทะฐะฟัััะธัั
sudo systemctl restart cowrie

# ะัะพัะผะพัั ะปะพะณะพะฒ systemd
sudo journalctl -u cowrie -f
```

### Docker ะบะพะผะฐะฝะดั

```bash
# ะััะฐะฝะพะฒะธัั ะฒัะต ัะตัะฒะธัั
docker-compose down

# ะะตัะตะทะฐะฟัััะธัั Cowrie
docker-compose restart cowrie

# ะัะพัะผะพัั ะปะพะณะพะฒ
docker-compose logs -f

# ะะฑะฝะพะฒะธัั ะบะพะฝัะตะนะฝะตัั
docker-compose pull
docker-compose up -d
```

## ๐ ะะฝะฐะปะธะท ะดะฐะฝะฝัั

### ะะพะปะตะทะฝัะต ะทะฐะฟัะพัั

#### ะขะพะฟ IP-ะฐะดัะตัะพะฒ ะฐัะฐะบัััะธั

```bash
jq -r 'select(.eventid=="cowrie.session.connect") | .src_ip' \
  cowrie/var/log/cowrie/cowrie.json | sort | uniq -c | sort -rn | head -20
```

#### ะขะพะฟ ะธัะฟะพะปัะทัะตะผัั ะฟะฐัะพะปะตะน

```bash
jq -r 'select(.eventid=="cowrie.login.success") | .password' \
  cowrie/var/log/cowrie/cowrie.json | sort | uniq -c | sort -rn | head -20
```

#### ะขะพะฟ ะฒัะฟะพะปะฝะตะฝะฝัั ะบะพะผะฐะฝะด

```bash
jq -r 'select(.eventid=="cowrie.command.input") | .input' \
  cowrie/var/log/cowrie/cowrie.json | sort | uniq -c | sort -rn | head -20
```

#### ะะฐะณััะถะตะฝะฝัะต ัะฐะนะปั

```bash
jq -r 'select(.eventid=="cowrie.session.file_download") | .url' \
  cowrie/var/log/cowrie/cowrie.json
```

## ๐ ะะฑะฝะพะฒะปะตะฝะธะต

### Docker

```bash
cd Honeypot
git pull
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### ะะฐัะธะฒะฝะฐั ัััะฐะฝะพะฒะบะฐ

```bash
cd /home/cowrie/cowrie
sudo -u cowrie git pull
sudo -u cowrie ./cowrie-env/bin/python -m pip install --upgrade -e .
sudo systemctl restart cowrie
```

## ๐ ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### Cowrie ะฝะต ะทะฐะฟััะบะฐะตััั

```bash
# ะัะพะฒะตัััะต ะปะพะณะธ
tail -n 100 cowrie/var/log/cowrie/cowrie.log

# ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ะดะพัััะฟะฐ
ls -la cowrie/var/

# ะัะพะฒะตัััะต ะบะพะฝัะธะณััะฐัะธั
./cowrie/bin/cowrie configtest
```

### ะะพัั ัะถะต ะธัะฟะพะปัะทัะตััั

```bash
# ะะฐะนะดะธัะต ะฟัะพัะตัั, ะธัะฟะพะปัะทัััะธะน ะฟะพัั
sudo lsof -i :2222
sudo lsof -i :22

# ะััะฐะฝะพะฒะธัะต ะบะพะฝัะปะธะบััััะธะน ัะตัะฒะธั
sudo systemctl stop ssh  # ะัะปะธ ะฝัะถะฝะพ
```

### Docker ะฟัะพะฑะปะตะผั

```bash
# ะะตัะตัะพะทะดะฐัั ะบะพะฝัะตะนะฝะตัั
docker-compose down -v
docker-compose up -d

# ะัะธััะธัั ะฝะตะธัะฟะพะปัะทัะตะผัะต ัะตััััั
docker system prune -a
```

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตััััั

- [ะัะธัะธะฐะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั Cowrie](https://docs.cowrie.org/)
- [GitHub ัะตะฟะพะทะธัะพัะธะน Cowrie](https://github.com/cowrie/cowrie)
- [Cowrie Slack ัะพะพะฑัะตััะฒะพ](https://www.cowrie.org/slack/)
- [Awesome Honeypots](https://github.com/paralax/awesome-honeypots)

## ๐ ะะธัะตะฝะทะธั

Cowrie ัะฐัะฟัะพัััะฐะฝัะตััั ะฟะพะด ะปะธัะตะฝะทะธะตะน BSD-3-Clause. ะกะผ. [LICENSE](https://github.com/cowrie/cowrie/blob/main/LICENSE.rst).

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั

ะัะปะธ ะฒั ัะพัะธัะต ัะปัััะธัั ััะพั ะฟัะพะตะบั:

1. Fork ัะตะฟะพะทะธัะพัะธะน
2. ะกะพะทะดะฐะนัะต feature branch (`git checkout -b feature/amazing-feature`)
3. Commit ะธะทะผะตะฝะตะฝะธั (`git commit -m 'Add amazing feature'`)
4. Push ะฒ branch (`git push origin feature/amazing-feature`)
5. ะัะบัะพะนัะต Pull Request

## โ๏ธ ะะธัะบะปะตะนะผะตั

ะญัะพั honeypot ะฟัะตะดะฝะฐะทะฝะฐัะตะฝ ัะพะปัะบะพ ะดะปั ะธััะปะตะดะพะฒะฐัะตะปััะบะธั ะธ ะพะฑัะฐะทะพะฒะฐัะตะปัะฝัั ัะตะปะตะน. ะัะฟะพะปัะทัะนัะต ะตะณะพ ะพัะฒะตัััะฒะตะฝะฝะพ ะธ ะฒ ัะพะพัะฒะตัััะฒะธะธ ั ะทะฐะบะพะฝะพะดะฐัะตะปัััะฒะพะผ ะฒะฐัะตะน ัััะฐะฝั. ะะฒัะพัั ะฝะต ะฝะตััั ะพัะฒะตัััะฒะตะฝะฝะพััะธ ะทะฐ ะฝะตะฟัะฐะฒะพะผะตัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต.

---

**ะกะพะทะดะฐะฝะพ ั โค๏ธ ะดะปั ะธะทััะตะฝะธั ะบะธะฑะตัะฑะตะทะพะฟะฐัะฝะพััะธ**

